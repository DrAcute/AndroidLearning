## 配置

新建一个Android Project

在**local.properties**中加入NDK目录位置

```
ndk.dir=D\:\\as_workplace\\Android\\android-ndk-r10d
```

## HelloWorld

### MainActivity

在MainActivity中加入

```java
public native String getStringFromNative();
```

### 使用Terminal生成头文件

使用Android Studio的 Terminal 切换至 MainActivity 的包目录所在位置，如

```
cd app\src\main\java
```
键入javah {MainActivity的全路径}

```
javah com.example.dracute.ndktest.MainActivity
```

这时java目录下就会下就会多出一个**com_example_dracute_ndktest_MainActivity.h**的文件，其内容如下

```c
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class com_example_dracute_ndktest_MainActivity */

#ifndef _Included_com_example_dracute_ndktest_MainActivity
#define _Included_com_example_dracute_ndktest_MainActivity
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     com_example_dracute_ndktest_MainActivity
 * Method:    getStringFromNative
 * Signature: ()Ljava/lang/String;
 */
JNIEXPORT jstring JNICALL Java_com_example_dracute_ndktest_MainActivity_getStringFromNative
  (JNIEnv *, jobject);

#ifdef __cplusplus
}
#endif
#endif

```

***把此文件移到jni目录下，不然可能会出现execution failed for task appcompileDebugNdk的bug***

### 加入.c文件
在jni目录下新建一个 .c文件。来实现头文件里面声明的方法。如main.c

```c
#include "com_example_dracute_ndktest_MainActivity.h"
/*
 * Class:     com_jnimobile_www_myjnidemo_MainActivity
 * Method:    getStringFromNative
 * Signature: ()Ljava/lang/String;
 */
JNIEXPORT jstring JNICALL Java_com_example_dracute_ndktest_MainActivity_getStringFromNative
        (JNIEnv * env, jobject obj){
    return (*env)->NewStringUTF(env,"I'm comes from to Native Function!");
}
```

### 完整的MainActivity文件

```java
public class MainActivity extends AppCompatActivity {

    static {
        System.loadLibrary("MyJni");
    }

    public native String getStringFromNative();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        TextView tv=(TextView)findViewById(R.id.tv);
        tv.setText(getStringFromNative());
    }
}

### 运行！

![NDK入门 HelloWorld _1.jpg](/Images/NDK入门 HelloWorld _1.jpg)
